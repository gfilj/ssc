function jBox(type,options){this.options={id:null,width:"auto",height:"auto",minWidth:null,maxHeight:null,minWidth:null,maxHeight:null,attach:null,trigger:"click",preventDefault:!1,title:null,content:null,getTitle:null,getContent:null,ajax:{url:null,data:"",reload:!1,getData:"data-ajax",setContent:!0,spinner:!0},target:null,position:{x:"center",y:"center"},outside:null,offset:0,attributes:{x:"left",y:"top"},adjustPosition:!1,adjustTracker:!1,adjustDistance:5,fixed:!1,reposition:!1,repositionOnOpen:!0,repositionOnContent:!0,pointer:!1,pointTo:"target",fade:180,animation:null,theme:"Default",addClass:"",overlay:!1,zIndex:1e4,delayOpen:0,delayClose:0,closeOnEsc:!1,closeOnClick:!1,closeOnMouseleave:!1,closeButton:!1,constructOnInit:!1,blockScroll:!1,appendTo:$("body"),draggable:null,dragOver:!0,onInit:function(){},onCreated:function(){},onOpen:function(){},onClose:function(){},onCloseComplete:function(){},confirmButton:"Submit",cancelButton:"Cancel",confirm:null,cancel:null,autoClose:7e3,color:null,stack:!0,audio:!1,volume:100,src:"href",gallery:"data-jbox-image",imageLabel:"title",imageFade:600,imageSize:"contain"},this.defaultOptions={Tooltip:{getContent:"title",trigger:"mouseenter",position:{x:"center",y:"top"},outside:"y",pointer:!0,adjustPosition:!0,reposition:!0},Mouse:{target:"mouse",position:{x:"right",y:"bottom"},offset:15,trigger:"mouseenter",adjustPosition:"flip"},Modal:{target:$(window),fixed:!0,blockScroll:!0,closeOnEsc:!0,closeOnClick:"overlay",closeButton:!0,overlay:!0,animation:"zoomOut"},Confirm:{target:$(window),fixed:!0,attach:$("[data-confirm]"),getContent:"data-confirm",content:"Do you really want to do this?",minWidth:320,maxWidth:460,blockScroll:!0,closeOnEsc:!0,closeOnClick:"overlay",closeButton:!0,overlay:!0,animation:"zoomOut",preventDefault:!0,_onAttach:function(a){if(!this.options.confirm){var b=a.attr("onclick")?a.attr("onclick"):a.attr("href")?a.attr("target")?'window.open("'+a.attr("href")+'", "'+a.attr("target")+'");':'window.location.href = "'+a.attr("href")+'";':"";a.prop("onclick",null).data("jBox-Confirm-submit",b)}},_onCreated:function(){this.footer=$('<div class="jBox-Confirm-footer"/>'),$('<div class="jBox-Confirm-button jBox-Confirm-button-cancel"/>').html(this.options.cancelButton).click(function(){this.options.cancel&&this.options.cancel(),this.close()}.bind(this)).appendTo(this.footer),this.submitButton=$('<div class="jBox-Confirm-button jBox-Confirm-button-submit"/>').html(this.options.confirmButton).appendTo(this.footer),this.footer.appendTo(this.container)},_onOpen:function(){this.submitButton.off("click.jBox-Confirm"+this.id).on("click.jBox-Confirm"+this.id,function(){this.options.confirm?this.options.confirm():eval(this.source.data("jBox-Confirm-submit")),this.close()}.bind(this))}},Notice:{target:$(window),fixed:!0,position:{x:20,y:20},attributes:{x:"right",y:"top"},animation:"zoomIn",closeOnClick:"box",_onInit:function(){this.open(),this.options.delayClose=this.options.autoClose,this.options.delayClose&&this.close()},_onCreated:function(){this.options.color&&this.wrapper.addClass("jBox-Notice-color jBox-Notice-"+this.options.color),this.wrapper.data("jBox-Notice-position",this.options.attributes.x+"-"+this.options.attributes.y)},_onOpen:function(){$.each($(".jBox-Notice"),function(a,b){return b=$(b),b.attr("id")!=this.id&&b.data("jBox-Notice-position")==this.options.attributes.x+"-"+this.options.attributes.y?this.options.stack?void b.css("margin-"+this.options.attributes.y,parseInt(b.css("margin-"+this.options.attributes.y))+this.wrapper.outerHeight()+10):void b.data("jBox").close({ignoreDelay:!0}):void 0}.bind(this)),this.options.audio&&this.audio({url:this.options.audio,valume:this.options.volume})},_onCloseComplete:function(){this.destroy()}},Image:{target:$(window),fixed:!0,blockScroll:!0,closeOnEsc:!0,closeOnClick:"overlay",closeButton:!0,overlay:!0,animation:"zoomOut",width:800,height:533,attach:$("[data-jbox-image]"),preventDefault:!0,_onInit:function(){this.images=this.currentImage={},this.imageZIndex=1,this.attachedElements&&$.each(this.attachedElements,function(a,b){if(b=$(b),!b.data("jBox-image-gallery")){var c=b.attr(this.options.gallery)||"default";!this.images[c]&&(this.images[c]=[]),this.images[c].push({src:b.attr(this.options.src),label:b.attr(this.options.imageLabel)||""}),"title"==this.options.imageLabel&&b.removeAttr("title"),b.data("jBox-image-gallery",c),b.data("jBox-image-id",this.images[c].length-1)}}.bind(this));var a=function(a,b,c,d){if(!$("#jBox-image-"+a+"-"+b).length){var e=$("<div/>",{id:"jBox-image-"+a+"-"+b,"class":"jBox-image-container"}).css({backgroundImage:"url("+this.images[a][b].src+")",backgroundSize:this.options.imageSize,opacity:d?1:0,zIndex:c?0:this.imageZIndex++}).appendTo(this.content);$("<div/>",{id:"jBox-image-label-"+a+"-"+b,"class":"jBox-image-label"+(d?" active":"")}).html(this.images[a][b].label).appendTo(this.imageLabel),!d&&!c&&e.animate({opacity:1},this.options.imageFade)}}.bind(this),b=function(a,b){$(".jBox-image-label.active").removeClass("active"),$("#jBox-image-label-"+a+"-"+b).addClass("active")};this.showImage=function(c){var d,e,f;"open"!=c?(d=this.currentImage.gallery,e=this.currentImage.id+(1*("prev"==c)?-1:1),e=e>this.images[d].length-1?0:0>e?this.images[d].length-1:e):(d=this.source.data("jBox-image-gallery"),e=this.source.data("jBox-image-id"),$(".jBox-image-pointer-prev, .jBox-image-pointer-next").css({display:this.images[d].length>1?"block":"none"})),this.currentImage={gallery:d,id:e},$("#jBox-image-"+d+"-"+e).length?($("#jBox-image-"+d+"-"+e).css({zIndex:this.imageZIndex++,opacity:0}).animate({opacity:1},"open"==c?0:this.options.imageFade),b(d,e)):(this.wrapper.addClass("jBox-loading"),$('<img src="'+this.images[d][e].src+'">').load(function(){a(d,e,!1),b(d,e),this.wrapper.removeClass("jBox-loading")}.bind(this))),f=e+1,f=f>this.images[d].length-1?0:0>f?this.images[d].length-1:f,!$("#jBox-image-"+d+"-"+f).length&&$('<img src="'+this.images[d][f].src+'">').load(function(){a(d,f,!0)})}},_onCreated:function(){this.imageLabel=$("<div/>",{id:"jBox-image-label"}).appendTo(this.wrapper),this.wrapper.append($("<div/>",{"class":"jBox-image-pointer-prev",click:function(){this.showImage("prev")}.bind(this)})).append($("<div/>",{"class":"jBox-image-pointer-next",click:function(){this.showImage("next")}.bind(this)}))},_onOpen:function(){$("body").addClass("jBox-image-open"),$(document).on("keyup.jBox-"+this.id,function(a){37==a.keyCode&&this.showImage("prev"),39==a.keyCode&&this.showImage("next")}.bind(this)),this.showImage("open")},_onClose:function(){$("body").removeClass("jBox-image-open"),$(document).off("keyup.jBox-"+this.id)},_onCloseComplete:function(){this.wrapper.find(".jBox-image-container").css("opacity",0)}}},"string"==$.type(type)&&(this.type=type,type=this.defaultOptions[type]),this.options=$.extend(!0,this.options,type,options),null===this.options.id&&(this.options.id="jBoxID"+jBox._getUniqueID()),this.id=this.options.id,("center"==this.options.position.x&&"x"==this.options.outside||"center"==this.options.position.y&&"y"==this.options.outside)&&(this.options.outside=!1),(!this.options.outside||"xy"==this.options.outside)&&(this.options.pointer=!1),"object"!=$.type(this.options.offset)&&(this.options.offset={x:this.options.offset,y:this.options.offset}),this.options.offset.x||(this.options.offset.x=0),this.options.offset.y||(this.options.offset.y=0),this.options.adjustDistance="object"!=$.type(this.options.adjustDistance)?{top:this.options.adjustDistance,right:this.options.adjustDistance,bottom:this.options.adjustDistance,left:this.options.adjustDistance}:$.extend({top:5,left:5,right:5,bottom:5},this.options.adjustDistance),this.align=this.options.outside&&"xy"!=this.options.outside?this.options.position[this.options.outside]:"center"!=this.options.position.y&&"number"!=$.type(this.options.position.y)?this.options.position.x:"center"!=this.options.position.x&&"number"!=$.type(this.options.position.x)?this.options.position.y:this.options.attributes.x,this.options.outside&&"xy"!=this.options.outside&&(this.outside=this.options.position[this.options.outside]);var userAgent=navigator.userAgent.toLowerCase();return this.IE8=-1!=userAgent.indexOf("msie")&&8==parseInt(userAgent.split("msie")[1]),this.prefix=-1!=userAgent.indexOf("webkit")?"-webkit-":"",this._getOpp=function(a){return{left:"right",right:"left",top:"bottom",bottom:"top",x:"y",y:"x"}[a]},this._getXY=function(a){return{left:"x",right:"x",top:"y",bottom:"y",center:"x"}[a]},this._getTL=function(a){return{left:"left",right:"left",top:"top",bottom:"top",center:"left",x:"left",y:"top"}[a]},this._supportsSVG=function(){return document.createElement("svg").getAttributeNS},this._createSVG=function(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg",a);return $.each(b,function(a,b){c.setAttribute(b[0],b[1]||"")}),c},this._appendSVG=function(a,b){return b.appendChild(a)},this._create=function(){var a,b,c;this.wrapper||(this.wrapper=$("<div/>",{id:this.id,"class":"jBox-wrapper"+(this.type?" jBox-"+this.type:"")+(this.options.theme?" jBox-"+this.options.theme:"")+(this.options.addClass?" "+this.options.addClass:"")+(this.IE8?" jBox-IE8":"")}).css({position:this.options.fixed?"fixed":"absolute",display:"none",opacity:0,zIndex:this.options.zIndex}).data("jBox",this),this.options.closeOnMouseleave&&this.wrapper.mouseleave(function(a){!this.source||!(a.relatedTarget==this.source[0]||-1!==$.inArray(this.source[0],$(a.relatedTarget).parents("*")))&&this.close()}.bind(this)),"box"==this.options.closeOnClick&&this.wrapper.on("touchend click",function(){this.close({ignoreDelay:!0})}.bind(this)),this.container=$("<div/>",{"class":"jBox-container"}).appendTo(this.wrapper),this.content=$("<div/>",{"class":"jBox-content"}).css({width:this.options.width,height:this.options.height,minWidth:this.options.minWidth,minHeight:this.options.minHeight,maxWidth:this.options.maxWidth,maxHeight:this.options.maxHeight}).appendTo(this.container),this.options.closeButton&&(this.closeButton=$("<div/>",{"class":"jBox-closeButton jBox-noDrag"}).on("touchend click",function(){this.isOpen&&this.close({ignoreDelay:!0})}.bind(this)),this._supportsSVG()?(a=this._createSVG("svg",[["viewBox","0 0 24 24"]]),this._appendSVG(this._createSVG("path",[["d","M22.2,4c0,0,0.5,0.6,0,1.1l-6.8,6.8l6.9,6.9c0.5,0.5,0,1.1,0,1.1L20,22.3c0,0-0.6,0.5-1.1,0L12,15.4l-6.9,6.9c-0.5,0.5-1.1,0-1.1,0L1.7,20c0,0-0.5-0.6,0-1.1L8.6,12L1.7,5.1C1.2,4.6,1.7,4,1.7,4L4,1.7c0,0,0.6-0.5,1.1,0L12,8.5l6.8-6.8c0.5-0.5,1.1,0,1.1,0L22.2,4z"]]),a),this.closeButton.append(a)):this.wrapper.addClass("jBox-nosvg"),("box"==this.options.closeButton||this.options.closeButton===!0&&!this.options.overlay&&!this.options.title)&&(this.wrapper.addClass("jBox-closeButton-box"),this.closeButton.appendTo(this.container))),this.wrapper.appendTo(this.options.appendTo),this.options.pointer&&(this.pointer={position:"target"!=this.options.pointTo?this.options.pointTo:this._getOpp(this.outside),xy:this._getXY("target"!=this.options.pointTo?this.options.pointTo:this.outside),align:"center",offset:0},this.pointer.element=$("<div/>",{"class":"jBox-pointer jBox-pointer-"+this.pointer.position}).appendTo(this.wrapper),this.pointer.dimensions={x:this.pointer.element.outerWidth(),y:0==this.pointer.element.outerHeight()?12:this.pointer.element.outerHeight()},"string"==$.type(this.options.pointer)&&(b=this.options.pointer.split(":"),b[0]&&(this.pointer.align=b[0]),b[1]&&(this.pointer.offset=parseInt(b[1]))),this.pointer.alignAttribute="x"==this.pointer.xy?"bottom"==this.pointer.align?"bottom":"top":"right"==this.pointer.align?"right":"left",this.wrapper.css("padding-"+this.pointer.position,this.pointer.dimensions[this.pointer.xy]),this.pointer.element.css(this.pointer.alignAttribute,"center"==this.pointer.align?"50%":0).css("margin-"+this.pointer.alignAttribute,this.pointer.offset),this.pointer.margin={},this.pointer.margin["margin-"+this.pointer.alignAttribute]=this.pointer.offset,"center"==this.pointer.align&&this.pointer.element.css(this.prefix+"transform","translate("+("y"==this.pointer.xy?this.pointer.dimensions.x*-.5+"px":0)+", "+("x"==this.pointer.xy?this.pointer.dimensions.y*-.5+"px":0)+")"),this.pointer.element.css("x"==this.pointer.xy?"width":"height",parseInt(this.pointer.dimensions[this.pointer.xy])+parseInt(this.container.css("border-"+this.pointer.alignAttribute+"-width"))),this.wrapper.addClass("jBox-pointerPosition-"+this.pointer.position)),this.setContent(this.options.content,!0),this.setTitle(this.options.title,!0),this.options.draggable&&(c="title"==this.options.draggable?this.titleContainer:this.options.draggable.length>0?this.options.draggable:this.options.draggable.selector?$(this.options.draggable.selector):this.wrapper,c.addClass("jBox-draggable").on("mousedown",function(a){if(2!=a.button&&!$(a.target).hasClass("jBox-noDrag")&&!$(a.target).parents(".jBox-noDrag").length){this.options.dragOver&&this.wrapper.css("zIndex")<=jBox.zIndexMax&&(jBox.zIndexMax+=1,this.wrapper.css("zIndex",jBox.zIndexMax));var b=this.wrapper.outerHeight(),c=this.wrapper.outerWidth(),d=this.wrapper.offset().top+b-a.pageY,e=this.wrapper.offset().left+c-a.pageX;$(document).on("mousemove.jBox-draggable-"+this.id,function(a){this.wrapper.offset({top:a.pageY+d-b,left:a.pageX+e-c})}.bind(this)),a.preventDefault()}}.bind(this)).on("mouseup",function(){$(document).off("mousemove.jBox-draggable-"+this.id)}.bind(this)),jBox.zIndexMax=jBox.zIndexMax?Math.max(jBox.zIndexMax,this.options.zIndex):this.options.zIndex),this.options.onCreated.bind(this)(),this.options._onCreated&&this.options._onCreated.bind(this)())},this.options.constructOnInit&&this._create(),this.options.attach&&this.attach(),this._positionMouse=function(a){this.pos={left:a.pageX,top:a.pageY};var b=function(a,b){return"center"==this.options.position[b]?void(this.pos[a]-=Math.ceil(this.dimensions[b]/2)):(this.pos[a]+=a==this.options.position[b]?-1*this.dimensions[b]-this.options.offset[b]:this.options.offset[b],this.pos[a])}.bind(this);this.wrapper.css({left:b("left","x"),top:b("top","y")}),this.targetDimensions={x:0,y:0,left:a.pageX,top:a.pageY},this._adjustPosition()},this._attachEvents=function(){if(this.options.closeOnEsc&&$(document).on("keyup.jBox-"+this.id,function(a){27==a.keyCode&&this.close({ignoreDelay:!0})}.bind(this)),(this.options.closeOnClick===!0||"body"==this.options.closeOnClick)&&$(document).on("touchend.jBox-"+this.id+" click.jBox-"+this.id,function(a){this.blockBodyClick||"body"==this.options.closeOnClick&&(a.target==this.wrapper[0]||this.wrapper.has(a.target).length)||this.close({ignoreDelay:!0})}.bind(this)),(this.options.adjustPosition&&this.options.adjustTracker||this.options.reposition)&&!this.fixed&&this.outside){var a,b=0,c=150,d=function(){var d=(new Date).getTime();a||(d-b>c&&(this.options.reposition&&this.position(),this.options.adjustTracker&&this._adjustPosition(),b=d),a=setTimeout(function(){a=null,b=(new Date).getTime(),this.options.reposition&&this.position(),this.options.adjustTracker&&this._adjustPosition()}.bind(this),c))}.bind(this);this.options.adjustTracker&&"resize"!=this.options.adjustTracker&&$(window).on("scroll.jBox-"+this.id,function(){d()}.bind(this)),(this.options.adjustTracker&&"scroll"!=this.options.adjustTracker||this.options.reposition)&&$(window).on("resize.jBox-"+this.id,function(){d()}.bind(this))}"mouse"==this.options.target&&$("body").on("mousemove.jBox-"+this.id,function(a){this._positionMouse(a)}.bind(this))},this._detachEvents=function(){this.options.closeOnEsc&&$(document).off("keyup.jBox-"+this.id),(this.options.closeOnClick===!0||"body"==this.options.closeOnClick)&&$(document).off("touchend.jBox-"+this.id+" click.jBox-"+this.id),(this.options.adjustPosition&&this.options.adjustTracker||this.options.reposition)&&($(window).off("scroll.jBox-"+this.id),$(window).off("resize.jBox-"+this.id)),"mouse"==this.options.target&&$("body").off("mousemove.jBox-"+this.id)},this._addOverlay=function(){this.overlay||(this.overlay=$("#jBox-overlay").length?$("#jBox-overlay").css({zIndex:Math.min($("#jBox-overlay").css("z-index"),this.options.zIndex-1)}):$("<div/>",{id:"jBox-overlay"}).css({display:"none",opacity:0,zIndex:this.options.zIndex-1}).appendTo($("body")),("overlay"==this.options.closeButton||this.options.closeButton===!0)&&($("#jBox-overlay .jBox-closeButton").length>0?$("#jBox-overlay .jBox-closeButton").on("touchend click",function(){this.isOpen&&this.close({ignoreDelay:!0})}.bind(this)):this.overlay.append(this.closeButton)),"overlay"==this.options.closeOnClick&&this.overlay.on("touchend click",function(){this.isOpen&&this.close({ignoreDelay:!0})}.bind(this)));var a=this.overlay.data("jBox")||{};a["jBox-"+this.id]=!0,this.overlay.data("jBox",a),"block"!=this.overlay.css("display")&&(this.options.fade?this.overlay.stop()&&this.overlay.animate({opacity:1},{queue:!1,duration:this.options.fade,start:function(){this.overlay.css({display:"block"})}.bind(this)}):this.overlay.css({display:"block",opacity:1}))},this._removeOverlay=function(){if(this.overlay){var a=this.overlay.data("jBox");delete a["jBox-"+this.id],this.overlay.data("jBox",a),$.isEmptyObject(a)&&(this.options.fade?this.overlay.stop()&&this.overlay.animate({opacity:0},{queue:!1,duration:this.options.fade,complete:function(){this.overlay.css({display:"none"})}.bind(this)}):this.overlay.css({display:"none",opacity:0}))}},this._generateCSS=function(){var a,b,c;this.IE8||("object"!=$.type(this.options.animation)&&(this.options.animation={pulse:{open:"pulse",close:"zoomOut"},zoomIn:{open:"zoomIn",close:"zoomIn"},zoomOut:{open:"zoomOut",close:"zoomOut"},move:{open:"move",close:"move"},slide:{open:"slide",close:"slide"},flip:{open:"flip",close:"flip"},tada:{open:"tada",close:"zoomOut"}}[this.options.animation]),this.options.animation.open&&(this.options.animation.open=this.options.animation.open.split(":")),this.options.animation.close&&(this.options.animation.close=this.options.animation.close.split(":")),this.options.animation.openDirection=this.options.animation.open?this.options.animation.open[1]:null,this.options.animation.closeDirection=this.options.animation.close?this.options.animation.close[1]:null,this.options.animation.open&&(this.options.animation.open=this.options.animation.open[0]),this.options.animation.close&&(this.options.animation.close=this.options.animation.close[0]),this.options.animation.open&&(this.options.animation.open+="Open"),this.options.animation.close&&(this.options.animation.close+="Close"),a={pulse:{duration:350,css:[["0%","scale(1)"],["50%","scale(1.1)"],["100%","scale(1)"]]},zoomInOpen:{duration:this.options.fade||180,css:[["0%","scale(0.9)"],["100%","scale(1)"]]},zoomInClose:{duration:this.options.fade||180,css:[["0%","scale(1)"],["100%","scale(0.9)"]]},zoomOutOpen:{duration:this.options.fade||180,css:[["0%","scale(1.1)"],["100%","scale(1)"]]},zoomOutClose:{duration:this.options.fade||180,css:[["0%","scale(1)"],["100%","scale(1.1)"]]},moveOpen:{duration:this.options.fade||180,positions:{top:{"0%":-12},right:{"0%":12},bottom:{"0%":12},left:{"0%":-12}},css:[["0%","translate%XY(%Vpx)"],["100%","translate%XY(0px)"]]},moveClose:{duration:this.options.fade||180,timing:"ease-in",positions:{top:{"100%":-12},right:{"100%":12},bottom:{"100%":12},left:{"100%":-12}},css:[["0%","translate%XY(0px)"],["100%","translate%XY(%Vpx)"]]},slideOpen:{duration:400,positions:{top:{"0%":-400},right:{"0%":400},bottom:{"0%":400},left:{"0%":-400}},css:[["0%","translate%XY(%Vpx)"],["100%","translate%XY(0px)"]]},slideClose:{duration:400,timing:"ease-in",positions:{top:{"100%":-400},right:{"100%":400},bottom:{"100%":400},left:{"100%":-400}},css:[["0%","translate%XY(0px)"],["100%","translate%XY(%Vpx)"]]},flipOpen:{duration:600,css:[["0%","perspective(400px) rotateX(90deg)"],["40%","perspective(400px) rotateX(-15deg)"],["70%","perspective(400px) rotateX(15deg)"],["100%","perspective(400px) rotateX(0deg)"]]},flipClose:{duration:this.options.fade||300,css:[["0%","perspective(400px) rotateX(0deg)"],["100%","perspective(400px) rotateX(90deg)"]]},tada:{duration:800,css:[["0%","scale(1)"],["10%, 20%","scale(0.9) rotate(-3deg)"],["30%, 50%, 70%, 90%","scale(1.1) rotate(3deg)"],["40%, 60%, 80%","scale(1.1) rotate(-3deg)"],["100%","scale(1) rotate(0)"]]}},$.each(["pulse","tada"],function(b,c){a[c+"Open"]=a[c+"Close"]=a[c]}),b=function(b,c){return keyframe_css="@"+this.prefix+"keyframes jBox-animation-"+this.options.animation[b]+"-"+b+(c?"-"+c:"")+" {",$.each(a[this.options.animation[b]].css,function(d,e){var f=c?e[1].replace("%XY",this._getXY(c).toUpperCase()):e[1];a[this.options.animation[b]].positions&&(f=f.replace("%V",a[this.options.animation[b]].positions[c][e[0]])),keyframe_css+=e[0]+" {"+this.prefix+"transform:"+f+";}"}.bind(this)),keyframe_css+="}",keyframe_css+=".jBox-animation-"+this.options.animation[b]+"-"+b+(c?"-"+c:"")+" {",keyframe_css+=this.prefix+"animation-duration: "+a[this.options.animation[b]].duration+"ms;",keyframe_css+=this.prefix+"animation-name: jBox-animation-"+this.options.animation[b]+"-"+b+(c?"-"+c:"")+";",keyframe_css+=a[this.options.animation[b]].timing?this.prefix+"animation-timing-function: "+a[this.options.animation[b]].timing+";":"",keyframe_css+="}"}.bind(this),c="",$.each(["open","close"],function(d,e){return this.options.animation[e]&&a[this.options.animation[e]]&&("close"!=e||this.options.fade)?void(a[this.options.animation[e]].positions?$.each(["top","right","bottom","left"],function(a,d){c+=b(e,d)}):c+=b(e)):""}.bind(this)),$("<style/>").append(c).appendTo($("head")))},this._blockBodyClick=function(){this.blockBodyClick=!0,setTimeout(function(){this.blockBodyClick=!1}.bind(this),10)},this.options.animation&&this._generateCSS(),this._animate=function(a){var b,c,d;if(!this.IE8){if(a||(a=this.isOpen?"open":"close"),!this.options.fade&&"close"==a)return null;b=this.options.animation[a+"Direction"]||("center"!=this.align?this.align:this.options.attributes.x),this.flipped&&this._getXY(b)==this._getXY(this.align)&&(b=this._getOpp(b)),c="jBox-animation-"+this.options.animation[a]+"-"+a+" jBox-animation-"+this.options.animation[a]+"-"+a+"-"+b,this.wrapper.addClass(c),d=1e3*parseFloat(this.wrapper.css(this.prefix+"animation-duration")),"close"==a&&(d=Math.min(d,this.options.fade)),setTimeout(function(){this.wrapper.removeClass(c)}.bind(this),d)}},this._abortAnimation=function(){if(!this.IE8){var a="jBox-animation",b=this.wrapper.attr("class").split(" ").filter(function(b){return 0!==b.lastIndexOf(a,0)});this.wrapper.attr("class",b.join(" "))}},this._adjustPosition=function(){var a,b,c,d,e,f,g,h,i,j,k;return this.options.adjustPosition?(this.positionAdjusted&&(this.wrapper.css(this.pos),this.pointer&&this.wrapper.css("padding",0).css("padding-"+this._getOpp(this.outside),this.pointer.dimensions[this._getXY(this.outside)]).removeClass("jBox-pointerPosition-"+this._getOpp(this.pointer.position)).addClass("jBox-pointerPosition-"+this.pointer.position),this.pointer&&this.pointer.element.attr("class","jBox-pointer jBox-pointer-"+this._getOpp(this.outside)).css(this.pointer.margin),this.positionAdjusted=!1,this.flipped=!1),a=$(window),b={x:a.width(),y:a.height(),top:this.options.fixed&&this.target.data("jBox-fixed")?0:a.scrollTop(),left:this.options.fixed&&this.target.data("jBox-fixed")?0:a.scrollLeft()},b.bottom=b.top+b.y,b.right=b.left+b.x,c=b.top>this.pos.top-(this.options.adjustDistance.top||0),d=b.right<this.pos.left+this.dimensions.x+(this.options.adjustDistance.right||0),e=b.bottom<this.pos.top+this.dimensions.y+(this.options.adjustDistance.bottom||0),f=b.left>this.pos.left-(this.options.adjustDistance.left||0),g=f?"left":d?"right":null,h=c?"top":e?"bottom":null,i=g||h,i&&("move"==this.options.adjustPosition||g!=this.outside&&h!=this.outside||("mouse"==this.target&&(this.outside="right"),("top"==this.outside||"left"==this.outside?b[this._getXY(this.outside)]-(this.targetDimensions[this._getTL(this.outside)]-b[this._getTL(this.outside)])-this.targetDimensions[this._getXY(this.outside)]+this.options.offset[this._getXY(this.outside)]:this.targetDimensions[this._getTL(this.outside)]-b[this._getTL(this.outside)]-this.options.offset[this._getXY(this.outside)])>this.dimensions[this._getXY(this.outside)]+parseInt(this.options.adjustDistance[this._getOpp(this.outside)])&&(this.wrapper.css(this._getTL(this.outside),this.pos[this._getTL(this.outside)]+(this.dimensions[this._getXY(this.outside)]+this.options.offset[this._getXY(this.outside)]*("top"==this.outside||"left"==this.outside?-2:2)+this.targetDimensions[this._getXY(this.outside)])*("top"==this.outside||"left"==this.outside?1:-1)),this.pointer&&this.wrapper.removeClass("jBox-pointerPosition-"+this.pointer.position).addClass("jBox-pointerPosition-"+this._getOpp(this.pointer.position)).css("padding",0).css("padding-"+this.outside,this.pointer.dimensions[this._getXY(this.outside)]),this.pointer&&this.pointer.element.attr("class","jBox-pointer jBox-pointer-"+this.outside),this.positionAdjusted=!0,this.flipped=!0)),j="x"==this._getXY(this.outside)?h:g,this.pointer&&"flip"!=this.options.adjustPosition&&this._getXY(j)==this._getOpp(this._getXY(this.outside))&&(k="center"==this.pointer.align?this.dimensions[this._getXY(j)]/2-this.pointer.dimensions[this._getOpp(this.pointer.xy)]/2-parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))*(j!=this._getTL(j)?-1:1):j==this.pointer.alignAttribute?parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute)):this.dimensions[this._getXY(j)]-parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))-this.pointer.dimensions[this._getXY(j)],spaceDiff=j==this._getTL(j)?b[this._getTL(j)]-this.pos[this._getTL(j)]+this.options.adjustDistance[j]:-1*(b[this._getOpp(this._getTL(j))]-this.pos[this._getTL(j)]-this.options.adjustDistance[j]-this.dimensions[this._getXY(j)]),j==this._getOpp(this._getTL(j))&&this.pos[this._getTL(j)]-spaceDiff<b[this._getTL(j)]+this.options.adjustDistance[this._getTL(j)]&&(spaceDiff-=b[this._getTL(j)]+this.options.adjustDistance[this._getTL(j)]-(this.pos[this._getTL(j)]-spaceDiff)),spaceDiff=Math.min(spaceDiff,k),k>=spaceDiff&&spaceDiff>0&&(this.pointer.element.css("margin-"+this.pointer.alignAttribute,parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))-spaceDiff*(j!=this.pointer.alignAttribute?-1:1)),this.wrapper.css(this._getTL(j),this.pos[this._getTL(j)]+spaceDiff*(j!=this._getTL(j)?-1:1)),this.positionAdjusted=!0))),void 0):null},this.options.onInit.bind(this)(),this.options._onInit&&this.options._onInit.bind(this)(),this}jBox.prototype.attach=function(a,b){return a||(a=$(this.options.attach.selector||this.options.attach)),b||(b=this.options.trigger),a&&a.length&&$.each(a,function(a,c){c=$(c),c.data("jBox-attached-"+this.id)||("title"==this.options.getContent&&void 0!=c.attr("title")&&c.data("jBox-getContent",c.attr("title")).removeAttr("title"),this.attachedElements||(this.attachedElements=[]),this.attachedElements.push(c[0]),c.on(b+".jBox-attach-"+this.id,function(a){if(this.timer&&clearTimeout(this.timer),"mouseenter"!=b||!this.isOpen||this.source[0]!=c[0]){if(this.isOpen&&this.source&&this.source[0]!=c[0])var d=!0;this.source=c,!this.options.target&&(this.target=c),"click"==b&&this.options.preventDefault&&a.preventDefault(),this["click"!=b||d?"open":"toggle"]()}}.bind(this)),"mouseenter"==this.options.trigger&&c.on("mouseleave",function(a){(!this.options.closeOnMouseleave||a.relatedTarget!=this.wrapper[0]&&!$(a.relatedTarget).parents("#"+this.id).length)&&this.close()}.bind(this)),c.data("jBox-attached-"+this.id,b),this.options._onAttach&&this.options._onAttach.bind(this)(c))}.bind(this)),this},jBox.prototype.detach=function(a){return a||(a=this.attachedElements||[]),a&&a.length&&$.each(a,function(a,b){b=$(b),b.data("jBox-attached-"+this.id)&&(b.off(b.data("jBox-attached-"+this.id)+".jBox-attach-"+this.id),b.data("jBox-attached-"+this.id,null)),this.attachedElements=$.grep(this.attachedElements,function(a){return a!=b[0]})}.bind(this)),this},jBox.prototype.setTitle=function(a,b){var c=this.wrapper.height(),d=this.wrapper.width();return null==a||void 0==a?this:(!this.wrapper&&this._create(),this.title||(this.titleContainer=$("<div/>",{"class":"jBox-title"}),this.title=$("<div/>").appendTo(this.titleContainer),this.wrapper.addClass("jBox-hasTitle"),("title"==this.options.closeButton||this.options.closeButton===!0&&!this.options.overlay)&&(this.wrapper.addClass("jBox-closeButton-title"),this.closeButton.appendTo(this.titleContainer)),this.titleContainer.insertBefore(this.content)),this.title.html(a),!b&&this.options.repositionOnContent&&(c!=this.wrapper.height()||d!=this.wrapper.width())&&this.position(),this)},jBox.prototype.setContent=function(a,b){var c,d,e,f,g;if(null==a)return this;switch(!this.wrapper&&this._create(),c=this.wrapper.height(),d=this.wrapper.width(),e=$("body").height(),f=$("body").width(),this.content.children("[data-jbox-content-appended]").appendTo("body").css({display:"none"}),$.type(a)){case"string":this.content.html(a);break;case"object":this.content.html(""),a.attr("data-jbox-content-appended",1).appendTo(this.content).css({display:"block"})}return g={x:f-$("body").width(),y:e-$("body").height()},!b&&this.options.repositionOnContent&&(c!=this.wrapper.height()||d!=this.wrapper.width())&&this.position({adjustOffset:g}),this},jBox.prototype.setDimensions=function(a,b,c){!this.wrapper&&this._create(),this.content.css(a,b),(void 0==c||c)&&this.position()},jBox.prototype.setWidth=function(a,b){this.setDimensions("width",a,b)},jBox.prototype.setHeight=function(a,b){this.setDimensions("height",a,b)},jBox.prototype.position=function(a){var b,c,d;if(a||(a={}),this.target=a.target||this.target||this.options.target||$(window),this.dimensions={x:this.wrapper.outerWidth(),y:this.wrapper.outerHeight()},"mouse"!=this.target){if("center"==this.options.position.x&&"center"==this.options.position.y)return this.wrapper.css({left:"50%",top:"50%",marginLeft:this.dimensions.x*-.5+this.options.offset.x,marginTop:this.dimensions.y*-.5+this.options.offset.y}),this;if(b=this.target.offset(),!this.target.data("jBox-fixed")&&this.target.data("jBox-fixed",this.target[0]==$(window)[0]||"fixed"!=this.target.css("position")&&this.target.parents().filter(function(){return"fixed"==$(this).css("position")}).length<=0?"static":"fixed"),"fixed"==this.target.data("jBox-fixed")&&this.options.fixed&&(b.top=b.top-$(window).scrollTop(),b.left=b.left-$(window).scrollLeft()),this.targetDimensions={x:this.target.width(),y:this.target.height(),top:b?b.top:0,left:b?b.left:0},this.pos={},c=function(a){if(-1==$.inArray(this.options.position[a],["top","right","bottom","left","center"]))return void(this.pos[this.options.attributes[a]]=this.options.position[a]);var b=this.options.attributes[a]="x"==a?"left":"top";return this.pos[b]=this.targetDimensions[b],"center"==this.options.position[a]?void(this.pos[b]+=Math.ceil((this.targetDimensions[a]-this.dimensions[a])/2)):(b!=this.options.position[a]&&(this.pos[b]+=this.targetDimensions[a]-this.dimensions[a]),void((this.options.outside==a||"xy"==this.options.outside)&&(this.pos[b]+=this.dimensions[a]*(b!=this.options.position[a]?1:-1))))}.bind(this),c("x"),c("y"),this.options.pointer&&"number"!=$.type(this.options.position.x)&&"number"!=$.type(this.options.position.y)){switch(d=0,this.pointer.align){case"center":"center"!=this.options.position[this._getOpp(this.options.outside)]&&(d+=this.dimensions[this._getOpp(this.options.outside)]/2);break;default:switch(this.options.position[this._getOpp(this.options.outside)]){case"center":d+=(this.dimensions[this._getOpp(this.options.outside)]/2-this.pointer.dimensions[this._getOpp(this.options.outside)]/2)*(this.pointer.align==this._getTL(this.pointer.align)?1:-1);break;default:d+=this.pointer.align!=this.options.position[this._getOpp(this.options.outside)]?this.dimensions[this._getOpp(this.options.outside)]*(-1!==$.inArray(this.pointer.align,["top","left"])?1:-1)+this.pointer.dimensions[this._getOpp(this.options.outside)]/2*(-1!==$.inArray(this.pointer.align,["top","left"])?-1:1):this.pointer.dimensions[this._getOpp(this.options.outside)]/2*(-1!==$.inArray(this.pointer.align,["top","left"])?1:-1)
}}d*=this.options.position[this._getOpp(this.options.outside)]==this.pointer.alignAttribute?-1:1,d+=this.pointer.offset*(this.pointer.align==this._getOpp(this._getTL(this.pointer.align))?1:-1),this.pos[this._getTL(this._getOpp(this.pointer.xy))]+=d}return a.adjustOffset&&a.adjustOffset.x&&(this.pos[this.options.attributes.x]+=parseInt(a.adjustOffset.x)*("left"==this.options.attributes.x?1:-1)),a.adjustOffset&&a.adjustOffset.y&&(this.pos[this.options.attributes.y]+=parseInt(a.adjustOffset.y)*("top"==this.options.attributes.y?1:-1)),this.pos[this.options.attributes.x]+=this.options.offset.x,this.pos[this.options.attributes.y]+=this.options.offset.y,this.wrapper.css(this.pos),this._adjustPosition(),this}},jBox.prototype.open=function(a){if(a||(a={}),this.isDestroyed)return!1;if(!this.wrapper&&this._create(),this.timer&&clearTimeout(this.timer),this._blockBodyClick(),this.isDisabled)return this;var b=function(){this.source&&this.options.getTitle&&(this.source.attr(this.options.getTitle)&&this.setTitle(this.source.attr(this.options.getTitle)),!0),this.source&&this.options.getContent&&(this.source.data("jBox-getContent")?this.setContent(this.source.data("jBox-getContent"),!0):this.source.attr(this.options.getContent)?this.setContent(this.source.attr(this.options.getContent),!0):null),this.options.onOpen.bind(this)(),this.options._onOpen&&this.options._onOpen.bind(this)(),(this.options.ajax&&this.options.ajax.url&&(!this.ajaxLoaded||this.options.ajax.reload)||a.ajax&&a.ajax.url)&&this.ajax(a.ajax||null),(!this.positionedOnOpen||this.options.repositionOnOpen)&&this.position({target:a.target})&&(this.positionedOnOpen=!0),this.isClosing&&this._abortAnimation(),this.isOpen||(this.isOpen=!0,this._attachEvents(),this.options.blockScroll&&$("body").addClass("jBox-blockScroll-"+this.id),this.options.overlay&&this._addOverlay(),this.options.animation&&!this.isClosing&&this._animate("open"),this.options.fade?this.wrapper.animate({opacity:1,display:"block"},{queue:!1,duration:this.options.fade,start:function(){this.isOpening=!0,this.wrapper.css({display:"block"})}.bind(this),always:function(){this.isOpening=!1}.bind(this)}):this.wrapper.css({display:"block",opacity:1}))}.bind(this);return!this.options.delayOpen||this.isOpen||this.isClosing||a.ignoreDelay?b():this.timer=setTimeout(b,this.options.delayOpen),this},jBox.prototype.close=function(a){if(a||(a={}),this.isDestroyed)return!1;if(this.timer&&clearTimeout(this.timer),this._blockBodyClick(),this.isDisabled)return this;var b=function(){this.options.onClose.bind(this)(),this.options._onClose&&this.options._onClose.bind(this)(),this.isOpen&&(this.isOpen=!1,this._detachEvents(),this.options.blockScroll&&$("body").removeClass("jBox-blockScroll-"+this.id),this.options.overlay&&this._removeOverlay(),this.options.animation&&!this.isOpening&&this._animate("close"),this.options.fade?this.wrapper.animate({opacity:0},{queue:!1,duration:this.options.fade,start:function(){this.isClosing=!0}.bind(this),complete:function(){this.wrapper.css({display:"none"}),this.options.onCloseComplete&&this.options.onCloseComplete.bind(this)(),this.options._onCloseComplete&&this.options._onCloseComplete.bind(this)()}.bind(this),always:function(){this.isClosing=!1}.bind(this)}):(this.wrapper.css({display:"none",opacity:0}),this.options._onCloseComplete&&this.options._onCloseComplete.bind(this)()))}.bind(this);return a.ignoreDelay?b():this.timer=setTimeout(b,Math.max(this.options.delayClose,10)),this},jBox.prototype.toggle=function(a){return this[this.isOpen?"close":"open"](a),this},jBox.prototype.disable=function(){return this.isDisabled=!0,this},jBox.prototype.enable=function(){return this.isDisabled=!1,this},jBox.prototype.ajax=function(a){var b,c,d,e;return a||(a={}),this.options.ajax.getData&&!a.data&&this.source&&void 0!=this.source.attr(this.options.ajax.getData)&&(a.data=this.source.attr(this.options.ajax.getData)||""),b=$.extend(!0,{},this.options.ajax),this.ajaxRequest&&this.ajaxRequest.abort(),c=a.beforeSend||b.beforeSend||function(){},d=a.complete||b.complete||function(){},e=$.extend(!0,b,a),e.beforeSend=function(){e.spinner&&(this.wrapper.addClass("jBox-loading"),this.spinner=$(e.spinner!==!0?e.spinner:'<div class="jBox-spinner"></div>').appendTo(this.container)),c.bind(this)()}.bind(this),e.complete=function(a){this.wrapper.removeClass("jBox-loading"),this.spinner&&this.spinner.remove(),e.setContent&&this.setContent(a.responseText),this.ajaxLoaded=!0,d.bind(this)(a)}.bind(this),this.ajaxRequest=$.ajax(e),this},jBox.prototype.audio=function(a){if(a||(a={}),jBox._audio||(jBox._audio={}),!a.url||this.IE8)return this;if(!jBox._audio[a.url]){var b=$("<audio/>");$("<source/>",{src:a.url+".mp3"}).appendTo(b),$("<source/>",{src:a.url+".ogg"}).appendTo(b),jBox._audio[a.url]=b[0]}jBox._audio[a.url].volume=Math.min(void 0!=a.volume?a.volume:(void 0!=this.options.volume?this.options.volume:100)/100,1),jBox._audio[a.url].pause();try{jBox._audio[a.url].currentTime=0}catch(c){}return jBox._audio[a.url].play(),this},jBox.prototype.destroy=function(){return this.detach().close({ignoreDelay:!0}),this.wrapper&&this.wrapper.remove(),this.isDestroyed=!0,this},jBox._getUniqueID=function(){var a=1;return function(){return a++}}(),$.fn.jBox=function(a,b){return a||(a={}),b||(b={}),new jBox(a,$.extend(b,{attach:this}))},Function.prototype.bind||(Function.prototype.bind=function(a){var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e});